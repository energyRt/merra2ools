<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started with `merra2ools` • merra2ools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started with `merra2ools`">
<meta property="og:description" content="merra2ools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-00GHMPMM37"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-00GHMPMM37');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">merra2ools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/merra2ools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/merra2.html">MERRA-2 subset</a>
    </li>
    <li>
      <a href="../articles/solarpower.html">Solar Power</a>
    </li>
    <li>
      <a href="../articles/windpower.html">Wind Power</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/energyRt/merra2ools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="merra2ools_files/header-attrs-2.7/header-attrs.js"></script><script src="merra2ools_files/kePrint-0.0.1/kePrint.js"></script><link href="merra2ools_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get started with <code>merra2ools</code>
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/energyRt/merra2ools/blob/master/vignettes/merra2ools.Rmd"><code>vignettes/merra2ools.Rmd</code></a></small>
      <div class="hidden name"><code>merra2ools.Rmd</code></div>

    </div>

    
    
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><strong>merra2ools</strong> is package for <a href="https://www.r-project.org/">R</a> and a dataset. It is assumed that R version &gt;=4.0 is pre-installed. (<a href="https://cran.r-project.org/bin/windows/Rtools/"><code>Rtools</code></a> is also required on Windows to build this and several other packages from source or GitHub). It is also recommended (though it is not required) to use <a href="https://www.rstudio.com/products/rstudio/download/">RStudio</a> or other IDE for R. <code>merra2ools</code> depends on several R-packages which (if not yet available on your system) will be installed along with the <code>merra2ools</code> installation (see the package <a href="https://github.com/energyRt/merra2ools/blob/master/DESCRIPTION">DESCRIPTION</a> for details). The package also requires its dataset to be downloaded separately from the installation of the package (see below). Though <code>merra2ools</code> package can operate without the dataset (for estimation capacity factors, solar geometry, etc.), the supplied data should be formatted in the same way as it is expected by the package functions.<br>
 <br><strong>merra2sample</strong> is 12-days example of the the <code>merra2ools</code> subset (41 years), 21st-day of each month of 2010. It can installed directly from GitHub, and used for quick checks of the data and its format; it is also used to build vignettes (articles) of <code>merra2ools</code> package. Since the example dataset has considerable size for R-packages (~0.5Gb) and mostly repeats the main dataset, it is saved as a separate package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pkg</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># returns names of installed packages</span>
<span class="co"># Installation of `merra2ools` package</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"remotes"</span> <span class="op">%in%</span> <span class="fu">pkg</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"merra2ools"</span> <span class="op">%in%</span> <span class="fu">pkg</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"energyRt/merra2ools"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"merra2sample"</span> <span class="op">%in%</span> <span class="fu">pkg</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"energyRt/merra2sample"</span><span class="op">)</span>
<span class="co"># Packages used in the vignette</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"rnaturalearthhires"</span> <span class="op">%in%</span> <span class="fu">pkg</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"ropensci/rnaturalearthhires"</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"scales"</span> <span class="op">%in%</span> <span class="fu">pkg</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"scales"</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"cowplot"</span> <span class="op">%in%</span> <span class="fu">pkg</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"cowplot"</span><span class="op">)</span></code></pre></div>
<p><strong><code>merra2ools</code> dataset</strong> (~270Gb) can be downloaded from <a href="https://doi.org/10.5061/dryad.v41ns1rtt">https://doi.org/10.5061/dryad.v41ns1rtt</a>, unziped in a dedicated directory on an internal or external hard-drive, and configured as described below.</p>
</div>
<div id="setting-up" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-up" class="anchor"></a>Setting up</h2>
<p>Loading packages used in the vignette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://energyRt.github.io/merra2ools/">merra2ools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></code></pre></div>
<p>Checking if the dataset is connected.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/merra2.html">check_merra2</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; 492 merra2ools data-files found</span></code></pre></div>
<p>Connecting the dataset (if not yet connected)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/merra2.html">check_merra2</a></span><span class="op">(</span><span class="st">"RAPLACE WITH PATH TO THE DOWNLOADED DATA"</span><span class="op">)</span> <span class="co"># check if the data in the directory</span>
<span class="fu"><a href="../reference/merra2.html">set_merra2_options</a></span><span class="op">(</span>merra2.dir <span class="op">=</span> <span class="st">"RAPLACE WITH PATH TO THE DOWNLOADED DATA"</span><span class="op">)</span> <span class="co"># safe the path</span>
<span class="fu"><a href="../reference/merra2.html">get_merra2_dir</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># check if the path is saved</span>
<span class="fu"><a href="../reference/merra2.html">check_merra2</a></span><span class="op">(</span>detailed <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
</div>
<div id="accessing-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#accessing-the-data" class="anchor"></a>Accessing the data</h2>
<p>The database is organized in monthly files in <code>fst</code> format. There are two functions to read a whole file (<code><a href="../reference/read_merra_file.html">read_merra_file()</a></code>) or read a subset for specified locations and time period (<code><a href="../reference/get_merra2_subset.html">get_merra2_subset()</a></code>). Both functions provide an option to read the dataset in the scaled format, in reported units (default) or “raw” format (as integers - the way it is stored).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_merra_file.html">read_merra_file</a></span><span class="op">(</span><span class="st">"202012"</span>, as_integers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<table class="table table">
<caption style="font-size: initial !important;">
Subset of raw data (as integers)
</caption>
<thead><tr>
<th style="text-align:left;">
UTC
</th>
<th style="text-align:right;">
locid
</th>
<th style="text-align:right;">
W10M.e1
</th>
<th style="text-align:right;">
W50M.e1
</th>
<th style="text-align:right;">
WDIR.e_1
</th>
<th style="text-align:right;">
T10M.C
</th>
<th style="text-align:right;">
SWGDN
</th>
<th style="text-align:right;">
ALBEDO.e2
</th>
<th style="text-align:right;">
PRECTOTCORR.kg_m2_h.e1
</th>
<th style="text-align:right;">
RHOA.e2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;min-width: 11em; background-color: lightgrey !important;">
2020-12-01 00:30:00
</td>
<td style="text-align:right;background-color: lightgrey !important;">
1
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-35
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 11em; background-color: lightgrey !important;">
2020-12-01 00:30:00
</td>
<td style="text-align:right;background-color: lightgrey !important;">
2
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-35
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 11em; background-color: lightgrey !important;">
2020-12-01 00:30:00
</td>
<td style="text-align:right;background-color: lightgrey !important;">
3
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-35
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 11em; background-color: lightgrey !important;">
2020-12-01 00:30:00
</td>
<td style="text-align:right;background-color: lightgrey !important;">
4
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-35
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 11em; background-color: lightgrey !important;">
2020-12-01 00:30:00
</td>
<td style="text-align:right;background-color: lightgrey !important;">
5
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-35
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_merra2_subset.html">get_merra2_subset</a></span><span class="op">(</span>from <span class="op">=</span> <span class="st">"20201130 01"</span>, to <span class="op">=</span> <span class="st">"20201201 23"</span><span class="op">)</span></code></pre></div>
<table class="table table">
<caption style="font-size: initial !important;">
merra2ools subset
</caption>
<thead><tr>
<th style="text-align:left;">
UTC
</th>
<th style="text-align:right;">
locid
</th>
<th style="text-align:right;">
W10M.e1
</th>
<th style="text-align:right;">
W50M.e1
</th>
<th style="text-align:right;">
WDIR.e_1
</th>
<th style="text-align:right;">
T10M.C
</th>
<th style="text-align:right;">
SWGDN
</th>
<th style="text-align:right;">
ALBEDO.e2
</th>
<th style="text-align:right;">
PRECTOTCORR.kg_m2_h.e1
</th>
<th style="text-align:right;">
RHOA.e2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;min-width: 11em; background-color: lightgrey !important;">
2020-12-01 00:30:00
</td>
<td style="text-align:right;background-color: lightgrey !important;">
1
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-35
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 11em; background-color: lightgrey !important;">
2020-12-01 00:30:00
</td>
<td style="text-align:right;background-color: lightgrey !important;">
2
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-35
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 11em; background-color: lightgrey !important;">
2020-12-01 00:30:00
</td>
<td style="text-align:right;background-color: lightgrey !important;">
3
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-35
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 11em; background-color: lightgrey !important;">
2020-12-01 00:30:00
</td>
<td style="text-align:right;background-color: lightgrey !important;">
4
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-35
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 11em; background-color: lightgrey !important;">
2020-12-01 00:30:00
</td>
<td style="text-align:right;background-color: lightgrey !important;">
5
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-35
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
99
</td>
</tr>
</tbody>
</table>
</div>
<div id="locations-identifiers" class="section level2">
<h2 class="hasAnchor">
<a href="#locations-identifiers" class="anchor"></a>Locations identifiers</h2>
<p>Every data-point in the used MERRA-2 collections (see the dataset description) is associated with coordinates and time. The original MERRA-2 files have index-variables <code>V1</code>, <code>V2</code>, and <code>V3</code> to identify longitude, latitude, and time (hour) dimensions respectively. For convenience, a location identifier <code>locid</code> has been generated as a Kronecker product of <code>V1</code> and <code>V2</code>. The <code>locid</code> identifier is used as the key variable of MERRA-2 locations, instead of <code>V1</code> and <code>V2</code>. The time identifier (<code>V3</code> - hour) is combined with the year, month, and day in <code>UTC</code> key variable. The total number of location points in MERRA-2 is 207,936 (576 X 361). The identifier is saved in the <code>merra2ools</code> package <code>\data</code> directory and can be called with <code>data</code> function (<code><a href="https://rdrr.io/r/utils/data.html">data("locid")</a></code>) or directly <code>locid</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Ways to call `locid` data.frame</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"locid"</span><span class="op">)</span>
<span class="fu">merra2ools</span><span class="fu">::</span><span class="va">locid</span>
<span class="va">locid</span></code></pre></div>
 <br><table class="table table">
<caption style="font-size: initial !important;">
Location identifiers
</caption>
<thead><tr>
<th style="text-align:right;">
lon
</th>
<th style="text-align:right;">
lat
</th>
<th style="text-align:right;">
locid
</th>
<th style="text-align:right;">
V1
</th>
<th style="text-align:right;">
V2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
-180.000
</td>
<td style="text-align:right;">
-90
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
-179.375
</td>
<td style="text-align:right;">
-90
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
-178.750
</td>
<td style="text-align:right;">
-90
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
178.125
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
207934
</td>
<td style="text-align:right;">
574
</td>
<td style="text-align:right;">
361
</td>
</tr>
<tr>
<td style="text-align:right;">
178.750
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
207935
</td>
<td style="text-align:right;">
575
</td>
<td style="text-align:right;">
361
</td>
</tr>
<tr>
<td style="text-align:right;">
179.375
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
207936
</td>
<td style="text-align:right;">
576
</td>
<td style="text-align:right;">
361
</td>
</tr>
</tbody>
</table>
<details><summary>
code
</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">locid</span><span class="op">$</span><span class="va">lon</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">lon</span>, <span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">lon</span><span class="op">)</span>

<span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">locid</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">lat</span>, <span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">lat</span><span class="op">)</span>

<span class="va">lo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">lon</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">lon</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">la</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span>, by <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>

<span class="va">locid_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">locid</span>, <span class="va">lon</span> <span class="op">%in%</span> <span class="va">lo</span>, <span class="va">lat</span> <span class="op">%in%</span> <span class="va">la</span><span class="op">)</span>
<span class="va">world_map</span> <span class="op">&lt;-</span> <span class="fu">rnaturalearth</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_countries.html">ne_countries</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"small"</span>, returnclass <span class="op">=</span> <span class="st">"sp"</span><span class="op">)</span>
<span class="va">world_map</span> <span class="op">&lt;-</span> <span class="fu">fortify</span><span class="op">(</span><span class="va">world_map</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span>

<span class="va">fig.locid</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_map</span><span class="op">(</span>data <span class="op">=</span> <span class="va">world_map</span>, map <span class="op">=</span> <span class="va">world_map</span>, 
           <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, map_id <span class="op">=</span> <span class="va">id</span><span class="op">)</span>, 
           fill <span class="op">=</span> <span class="st">"wheat"</span>, alpha <span class="op">=</span> <span class="fl">.75</span>, colour <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_rect</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">xmin</span>, xmax <span class="op">=</span> <span class="va">xmax</span>, ymin <span class="op">=</span> <span class="va">ymin</span>, ymax <span class="op">=</span> <span class="va">ymax</span><span class="op">)</span>,
    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">180</span>, xmax <span class="op">=</span> <span class="fl">180</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="fl">90</span>, ymax <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,
    alpha <span class="op">=</span> <span class="fl">.5</span>, fill <span class="op">=</span> <span class="cn">NA</span>, colour <span class="op">=</span> <span class="st">"grey85"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">locid_sample</span>, size <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">lon</span>, y <span class="op">=</span> <span class="va">lat</span>, label <span class="op">=</span> <span class="va">locid</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">locid_sample</span>, 
             position <span class="op">=</span> <span class="fu">position_nudge</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
             alpha <span class="op">=</span> <span class="fl">0.75</span>,
             size <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">3</span>, <span class="st">"lines"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="va">lo</span><span class="op">)</span>, minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="va">lo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">la</span><span class="op">)</span>, minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="va">la</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"lon"</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># labs(x = "lon", title = "Location ID (`locid`) layout of MERRA-2 subset") +</span>
  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="fl">1.</span><span class="op">)</span>

<span class="fu">ggsave</span><span class="op">(</span><span class="st">"images/locid_map.png"</span>, <span class="va">fig.locid</span>, width <span class="op">=</span> <span class="fl">9</span>, height <span class="op">=</span> <span class="fl">5.</span><span class="op">)</span></code></pre></div>
</details><div class="figure" style="text-align: center">
<img src="../images/locid_map.png" alt="locid_map" width="1350"><p class="caption">
locid_map
</p>
</div>
</div>
<div id="matching-locid-with-a-map" class="section level2">
<h2 class="hasAnchor">
<a href="#matching-locid-with-a-map" class="anchor"></a>Matching <code>locid</code> with a map</h2>
<p>Location identifiers in <code>merra2ools</code> dataset can be seen as spatial points or centers (centroids) of a spatial grid or spatial polygons. Subsetting <code>locid</code> for a particular geographical region can be done using a “map” of the region in <code>SpatialPolygonsDataFrame</code> format (<code>spdf</code>). Function <code>get_locid</code> offers two alternative criteria of selecting <code>locid</code>s is implemented in <code>get_locid</code> function:<br>
* <code>locid</code> as a spatial points <em>overlay</em> the map’s spatial polygons (method = “points”);<br>
* <code>locid</code> as a spatial polygon <em>intersect</em> with the map’s spatial polygons (method = “intersect”).</p>
<p> <br>
Three examples below compare subsetting with the two methods for three different regions/countries.</p>
<div id="example-1--florida-usa" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1--florida-usa" class="anchor"></a>Example 1. Florida, USA</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># US-map</span>
<span class="va">usa_sp</span> <span class="op">&lt;-</span> <span class="fu">rnaturalearth</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_states.html">ne_states</a></span><span class="op">(</span>iso_a2 <span class="op">=</span> <span class="st">"us"</span><span class="op">)</span>

<span class="co"># Subset Florida map (keep two formats - `spdf` and `sf`)</span>
<span class="va">florida_sp</span> <span class="op">&lt;-</span> <span class="va">usa_sp</span><span class="op">[</span><span class="va">usa_sp</span><span class="op">$</span><span class="va">name_en</span> <span class="op">==</span> <span class="st">"Florida"</span>,<span class="op">]</span>
<span class="va">florida_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">florida_sp</span><span class="op">[</span>, <span class="st">"name"</span><span class="op">]</span><span class="op">)</span>

<span class="co"># location IDs, two methods</span>
<span class="va">locid_fl_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_locid.html">get_locid</a></span><span class="op">(</span><span class="va">florida_sp</span>, method <span class="op">=</span> <span class="st">"points"</span><span class="op">)</span>
<span class="va">locid_fl_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_locid.html">get_locid</a></span><span class="op">(</span><span class="va">florida_sp</span>, method <span class="op">=</span> <span class="st">"intersect"</span><span class="op">)</span>

<span class="co"># MERRA-2 grid for the selected `locid's`</span>
<span class="va">locid_fl_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getGrid.html">getGrid</a></span><span class="op">(</span><span class="st">"poly"</span>, locid <span class="op">=</span> <span class="va">locid_fl_i</span><span class="op">)</span>
<span class="co"># locid_fl_sp &lt;- get_locid(florida_sp, return_sp = T)</span>

<span class="co"># Plots</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="st">"images/example1_florida_locids.png"</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">florida_sp</span>, axes <span class="op">=</span> <span class="cn">T</span>, col <span class="op">=</span> <span class="st">"wheat"</span><span class="op">)</span>
<span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">locid_fl_grid</span>, add <span class="op">=</span> <span class="cn">T</span>, border <span class="op">=</span> <span class="st">"darkgrey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">locid</span><span class="op">$</span><span class="va">lon</span><span class="op">[</span><span class="va">locid_fl_p</span><span class="op">]</span>, <span class="va">locid</span><span class="op">$</span><span class="va">lat</span><span class="op">[</span><span class="va">locid_fl_p</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">locid</span><span class="op">$</span><span class="va">lon</span><span class="op">[</span><span class="va">locid_fl_i</span><span class="op">]</span>, <span class="va">locid</span><span class="op">$</span><span class="va">lat</span><span class="op">[</span><span class="va">locid_fl_i</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="../images/example1_florida_locids.png" alt="MERRA-2 locations for Florida" width="500"><p class="caption">
MERRA-2 locations for Florida
</p>
</div>
</div>
<div id="example-2--iceland" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2--iceland" class="anchor"></a>Example 2. Iceland</h3>
<details><summary>
code
</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Map</span>
<span class="co"># iceland_sp &lt;- rnaturalearth::ne_states(country = "iceland")</span>
<span class="va">iceland_sp</span> <span class="op">&lt;-</span> <span class="fu">rnaturalearth</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_countries.html">ne_countries</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">"iceland"</span>, scale <span class="op">=</span> <span class="st">"large"</span><span class="op">)</span>
<span class="va">iceland_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">iceland_sp</span><span class="op">[</span>, <span class="st">"name"</span><span class="op">]</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">iceland_sp</span><span class="op">@</span><span class="va">data</span><span class="op">)</span>
<span class="co"># location IDs, two methods</span>
<span class="va">locid_isl_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_locid.html">get_locid</a></span><span class="op">(</span><span class="va">iceland_sp</span>, method <span class="op">=</span> <span class="st">"points"</span><span class="op">)</span>
<span class="va">locid_isl_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_locid.html">get_locid</a></span><span class="op">(</span><span class="va">iceland_sp</span>, method <span class="op">=</span> <span class="st">"intersect"</span><span class="op">)</span>

<span class="co"># MERRA-2 grid for the selected `locid's`</span>
<span class="va">locid_isl_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getGrid.html">getGrid</a></span><span class="op">(</span><span class="st">"poly"</span>, locid <span class="op">=</span> <span class="va">locid_isl_i</span><span class="op">)</span>

<span class="co"># Plots</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="st">"images/example2_iceland_locids.png"</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">iceland_sp</span>, axes <span class="op">=</span> <span class="cn">T</span>, col <span class="op">=</span> <span class="st">"wheat"</span><span class="op">)</span>
<span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">locid_isl_grid</span>, add <span class="op">=</span> <span class="cn">T</span>, border <span class="op">=</span> <span class="st">"darkgrey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">locid</span><span class="op">$</span><span class="va">lon</span><span class="op">[</span><span class="va">locid_isl_p</span><span class="op">]</span>, <span class="va">locid</span><span class="op">$</span><span class="va">lat</span><span class="op">[</span><span class="va">locid_isl_p</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">locid</span><span class="op">$</span><span class="va">lon</span><span class="op">[</span><span class="va">locid_isl_i</span><span class="op">]</span>, <span class="va">locid</span><span class="op">$</span><span class="va">lat</span><span class="op">[</span><span class="va">locid_isl_i</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</details><div class="figure" style="text-align: center">
<img src="../images/example2_iceland_locids.png" alt="MERRA-2 locations for Iceland" width="500"><p class="caption">
MERRA-2 locations for Iceland
</p>
</div>
</div>
<div id="example-3--kenya" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3--kenya" class="anchor"></a>Example 3. Kenya</h3>
<details><summary>
code
</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Map</span>
<span class="co"># kenya_sp &lt;- rnaturalearth::ne_states(country = "kenya")</span>
<span class="va">kenya_sp</span> <span class="op">&lt;-</span> <span class="fu">rnaturalearth</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_countries.html">ne_countries</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">"kenya"</span>, scale <span class="op">=</span> <span class="st">"large"</span><span class="op">)</span>
<span class="va">kenya_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">kenya_sp</span><span class="op">[</span>, <span class="st">"name"</span><span class="op">]</span><span class="op">)</span>

<span class="co"># location IDs, two methods</span>
<span class="va">locid_ken_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_locid.html">get_locid</a></span><span class="op">(</span><span class="va">kenya_sp</span>, method <span class="op">=</span> <span class="st">"points"</span><span class="op">)</span>
<span class="va">locid_ken_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_locid.html">get_locid</a></span><span class="op">(</span><span class="va">kenya_sp</span>, method <span class="op">=</span> <span class="st">"intersect"</span><span class="op">)</span>

<span class="co"># MERRA-2 grid for the selected `locid's`</span>
<span class="va">locid_ken_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getGrid.html">getGrid</a></span><span class="op">(</span><span class="st">"poly"</span>, locid <span class="op">=</span> <span class="va">locid_ken_i</span><span class="op">)</span>

<span class="co"># Plots</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="st">"images/example3_kenya_locids.png"</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">kenya_sp</span>, axes <span class="op">=</span> <span class="cn">T</span>, col <span class="op">=</span> <span class="st">"wheat"</span>, main <span class="op">=</span> <span class="st">"Kenya"</span><span class="op">)</span>
<span class="fu">sp</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">locid_ken_grid</span>, add <span class="op">=</span> <span class="cn">T</span>, border <span class="op">=</span> <span class="st">"darkgrey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">locid</span><span class="op">$</span><span class="va">lon</span><span class="op">[</span><span class="va">locid_ken_p</span><span class="op">]</span>, <span class="va">locid</span><span class="op">$</span><span class="va">lat</span><span class="op">[</span><span class="va">locid_ken_p</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">locid</span><span class="op">$</span><span class="va">lon</span><span class="op">[</span><span class="va">locid_ken_i</span><span class="op">]</span>, <span class="va">locid</span><span class="op">$</span><span class="va">lat</span><span class="op">[</span><span class="va">locid_ken_i</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</details><div class="figure" style="text-align: center">
<img src="../images/example3_kenya_locids.png" alt="MERRA-2 locations for Kenya" width="500"><p class="caption">
MERRA-2 locations for Kenya
</p>
</div>
</div>
</div>
<div id="get-merra-2-subset" class="section level2">
<h2 class="hasAnchor">
<a href="#get-merra-2-subset" class="anchor"></a>Get MERRA-2 subset</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">merra_fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_merra2_subset.html">get_merra2_subset</a></span><span class="op">(</span>locid <span class="op">=</span> <span class="va">locid_fl_i</span>, 
                              from <span class="op">=</span> <span class="st">"20190101 00"</span>, to <span class="op">=</span> <span class="st">"20191231 23"</span>, 
                              tz <span class="op">=</span> <span class="st">"US/Eastern"</span><span class="op">)</span>

<span class="va">merra_isl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_merra2_subset.html">get_merra2_subset</a></span><span class="op">(</span>locid <span class="op">=</span> <span class="va">locid_isl_i</span>, 
                               from <span class="op">=</span> <span class="st">"20190101 00"</span>, to <span class="op">=</span> <span class="st">"20191231 23"</span>, 
                               tz <span class="op">=</span> <span class="st">"Atlantic/Reykjavik"</span><span class="op">)</span>

<span class="va">merra_ken</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_merra2_subset.html">get_merra2_subset</a></span><span class="op">(</span>locid <span class="op">=</span> <span class="va">locid_ken_i</span>, 
                               from <span class="op">=</span> <span class="st">"20190101 00"</span>, to <span class="op">=</span> <span class="st">"20191231 23"</span>, 
                               tz <span class="op">=</span> <span class="st">"Africa/Nairobi"</span><span class="op">)</span></code></pre></div>
</div>
<div id="wind-power" class="section level2">
<h2 class="hasAnchor">
<a href="#wind-power" class="anchor"></a>Wind power</h2>
<p>Estimation of wind power capacity factors (CF) for the first example - <em>Florida</em>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimate capacity factors</span>
<span class="va">merra_fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fWindCF.html">fWindCF</a></span><span class="op">(</span><span class="va">merra_fl</span>, height <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>

<span class="co"># Annual averages</span>
<span class="va">win_fl_y</span> <span class="op">&lt;-</span> <span class="va">merra_fl</span> <span class="op">%&gt;%</span> <span class="co"># annual averages</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">locid</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>win150af <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">win150af</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_coord.html">add_coord</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
Do the same for other examples - Iceland and Kenya.<br><details><summary>
code
</summary><p><strong>Iceland</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimate capacity factors</span>
<span class="va">merra_isl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fWindCF.html">fWindCF</a></span><span class="op">(</span><span class="va">merra_isl</span>, height <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>

<span class="co"># Annual averages</span>
<span class="va">win_isl_y</span> <span class="op">&lt;-</span> <span class="va">merra_isl</span> <span class="op">%&gt;%</span> <span class="co"># annual averages</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">locid</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>win150af <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">win150af</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_coord.html">add_coord</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><strong>Kenya</strong></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimate capacity factors</span>
<span class="va">merra_ken</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fWindCF.html">fWindCF</a></span><span class="op">(</span><span class="va">merra_ken</span>, height <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>

<span class="co"># Annual averages</span>
<span class="va">win_ken_y</span> <span class="op">&lt;-</span> <span class="va">merra_ken</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">locid</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>win150af <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">win150af</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_coord.html">add_coord</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</details>
</div>
<div id="solar-power" class="section level2">
<h2 class="hasAnchor">
<a href="#solar-power" class="anchor"></a>Solar power</h2>
<p>Estimation of Plane of Array Irradiance (POA) for fixed tilted (fl) array-systems for <em>Florida</em></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimate POA</span>
<span class="va">merra_fl</span> <span class="op">&lt;-</span> <span class="va">merra_fl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/poa_irradiance.html">fPOA</a></span><span class="op">(</span>array.type <span class="op">=</span> <span class="st">"fl"</span><span class="op">)</span>

<span class="co"># Annual averages</span>
<span class="va">poa_fl_y</span> <span class="op">&lt;-</span> <span class="va">merra_fl</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">locid</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>POA.fl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">POA.fl</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">/</span><span class="fl">365</span><span class="op">/</span><span class="fl">1e3</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_coord.html">add_coord</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></code></pre></div>
Repeat for other examples.<br><details><summary>
code
</summary><p><strong>Iceland</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimate POA</span>
<span class="va">merra_isl</span> <span class="op">&lt;-</span> <span class="va">merra_isl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/poa_irradiance.html">fPOA</a></span><span class="op">(</span>array.type <span class="op">=</span> <span class="st">"fl"</span><span class="op">)</span>

<span class="co"># Annual averages</span>
<span class="va">poa_isl_y</span> <span class="op">&lt;-</span> <span class="va">merra_isl</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">locid</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>POA.fl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">POA.fl</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">/</span><span class="fl">365</span><span class="op">/</span><span class="fl">1e3</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_coord.html">add_coord</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><strong>Kenya</strong></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimate POA</span>
<span class="va">merra_ken</span> <span class="op">&lt;-</span> <span class="va">merra_ken</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/poa_irradiance.html">fPOA</a></span><span class="op">(</span>array.type <span class="op">=</span> <span class="st">"fl"</span><span class="op">)</span>

<span class="co"># Annual averages</span>
<span class="va">poa_ken_y</span> <span class="op">&lt;-</span> <span class="va">merra_ken</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">locid</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>POA.fl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">POA.fl</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">/</span><span class="fl">365</span><span class="op">/</span><span class="fl">1e3</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_coord.html">add_coord</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><strong>Comparative figure</strong><br>
To use the same scale,</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wnd_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">win_fl_y</span><span class="op">$</span><span class="va">win150af</span>, <span class="va">win_isl_y</span><span class="op">$</span><span class="va">win150af</span>, <span class="va">win_ken_y</span><span class="op">$</span><span class="va">win150af</span><span class="op">)</span>
<span class="va">wnd_breaks</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/breaks_pretty.html">breaks_pretty</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">(</span><span class="va">wnd_range</span><span class="op">)</span>
<span class="va">wnd_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">wnd_breaks</span><span class="op">)</span>

<span class="va">poa_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">poa_fl_y</span><span class="op">$</span><span class="va">POA.fl</span>, <span class="va">poa_isl_y</span><span class="op">$</span><span class="va">POA.fl</span>, <span class="va">poa_ken_y</span><span class="op">$</span><span class="va">POA.fl</span><span class="op">)</span>
<span class="va">poa_breaks</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/breaks_pretty.html">breaks_pretty</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">(</span><span class="va">poa_range</span><span class="op">)</span>
<span class="va">poa_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">poa_breaks</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot capacity factor variable on map</span>
<span class="va">cf_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span>
  <span class="va">data</span>, <span class="va">gis_sf</span>, <span class="va">var_name</span>, <span class="va">brakes</span>, 
  <span class="va">labels</span> <span class="op">=</span> <span class="va">brakes</span>, <span class="va">limits</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">brakes</span><span class="op">)</span>, <span class="va">legend_name</span> <span class="op">=</span> <span class="va">var_name</span>,
  <span class="va">viridis_palette</span> <span class="op">=</span> <span class="st">"viridis"</span>, <span class="va">border_colour</span> <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"white"</span>, <span class="fl">.5</span><span class="op">)</span>,
  <span class="va">legend_position</span> <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_tile</span><span class="op">(</span><span class="fu">aes_string</span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span>, fill <span class="op">=</span> <span class="va">var_name</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_fill_viridis_c</span><span class="op">(</span>
      breaks <span class="op">=</span> <span class="va">brakes</span>, labels <span class="op">=</span> <span class="va">labels</span>, limits <span class="op">=</span> <span class="va">limits</span>, name <span class="op">=</span> <span class="va">legend_name</span>,
      option <span class="op">=</span> <span class="va">viridis_palette</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">gis_sf</span>, fill <span class="op">=</span> <span class="cn">NA</span>, colour <span class="op">=</span> <span class="va">border_colour</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="va">legend_position</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme</span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Combine plots into one</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span>
  <span class="fu">cf_plot</span><span class="op">(</span><span class="va">win_fl_y</span>, <span class="va">florida_sf</span>, <span class="st">"win150af"</span>, <span class="va">wnd_breaks</span><span class="op">)</span>,
  <span class="fu">cf_plot</span><span class="op">(</span><span class="va">win_isl_y</span>, <span class="va">iceland_sf</span>, <span class="st">"win150af"</span>, <span class="va">wnd_breaks</span><span class="op">)</span>,
  <span class="fu">cf_plot</span><span class="op">(</span><span class="va">win_ken_y</span>, <span class="va">kenya_sf</span>, <span class="st">"win150af"</span>, <span class="va">wnd_breaks</span>,
          legend_position <span class="op">=</span> <span class="st">"right"</span>, legend_name <span class="op">=</span> <span class="st">"Wind\nCF"</span><span class="op">)</span>,
  <span class="co"># NULL, NULL, NULL,  </span>
  <span class="fu">cf_plot</span><span class="op">(</span><span class="va">poa_fl_y</span>, <span class="va">florida_sf</span>, <span class="st">"POA.fl"</span>, <span class="va">poa_breaks</span>, viridis_palette <span class="op">=</span> <span class="st">"plasma"</span><span class="op">)</span>,
  <span class="fu">cf_plot</span><span class="op">(</span><span class="va">poa_isl_y</span>, <span class="va">iceland_sf</span>, <span class="st">"POA.fl"</span>, <span class="va">poa_breaks</span>, viridis_palette <span class="op">=</span> <span class="st">"plasma"</span><span class="op">)</span>,
  <span class="fu">cf_plot</span><span class="op">(</span><span class="va">poa_ken_y</span>, <span class="va">kenya_sf</span>, <span class="st">"POA.fl"</span>, <span class="va">poa_breaks</span>, viridis_palette <span class="op">=</span> <span class="st">"plasma"</span>,
          legend_position <span class="op">=</span> <span class="st">"right"</span>, legend_name <span class="op">=</span> <span class="st">"POA\nkW/day"</span><span class="op">)</span>,
  <span class="co"># rel_heights = c(1, -.3, 1),</span>
  ncol <span class="op">=</span> <span class="fl">3</span>, rel_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.25</span>, <span class="fl">1.23</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Florida"</span>, <span class="st">"Iceland"</span>, <span class="st">"Kenya"</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.6</span>, <span class="op">-</span><span class="fl">1.9</span>, <span class="op">-</span><span class="fl">1.6</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/ggsave2.html">ggsave2</a></span><span class="op">(</span><span class="st">"images/cf_group.png"</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">5</span>, dpi <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></code></pre></div>
</details><div class="figure" style="text-align: center">
<img src="../images/cf_group.png" alt="Wind power capacity factors (CF) and Solar irradiance on Plane of Array (POA) by regions" width="800"><p class="caption">
Wind power capacity factors (CF) and Solar irradiance on Plane of Array (POA) by regions
</p>
</div>
</div>
<div id="precipitation-by-months" class="section level2">
<h2 class="hasAnchor">
<a href="#precipitation-by-months" class="anchor"></a>Precipitation by months</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prec_ken_m</span> <span class="op">&lt;-</span> <span class="va">merra_ken</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    local_time <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/with_tz.html">with_tz</a></span><span class="op">(</span><span class="va">UTC</span>, <span class="st">"Africa/Nairobi"</span><span class="op">)</span>,
    year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">local_time</span><span class="op">)</span>,
    month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">local_time</span><span class="op">)</span>,
    month_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">month.name</span><span class="op">[</span><span class="va">month</span><span class="op">]</span>, levels <span class="op">=</span> <span class="va">month.name</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">locid</span>, <span class="va">year</span>, <span class="va">month</span>, <span class="va">month_name</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>
    PRECTOTCORR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PRECTOTCORR</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,
    T10M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">T10M</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/add_coord.html">add_coord</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<details><summary>
code
</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pre_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">prec_ken_m</span><span class="op">$</span><span class="va">PRECTOTCORR</span><span class="op">)</span>
<span class="va">pre_breaks</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/breaks_pretty.html">breaks_pretty</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">(</span><span class="va">pre_range</span><span class="op">)</span>
<span class="va">pre_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">pre_breaks</span><span class="op">)</span>

<span class="fu">cf_plot</span><span class="op">(</span><span class="va">prec_ken_m</span>, <span class="va">kenya_sf</span>, <span class="st">"PRECTOTCORR"</span>, brakes <span class="op">=</span> <span class="va">pre_breaks</span>, legend_position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">month</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">prec_ken_m</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_tile</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, fill <span class="op">=</span> <span class="va">PRECTOTCORR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_distiller</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"YlGnBu"</span>, direction <span class="op">=</span> <span class="fl">1</span>, name <span class="op">=</span> <span class="st">"mm /\nmonth"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">month_name</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">kenya_sf</span>, fill <span class="op">=</span> <span class="cn">NA</span>, colour <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"black"</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu">ggsave</span><span class="op">(</span><span class="st">"images/precipitation_m_kenya.png"</span>, scale <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">prec_ken_m</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_tile</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, fill <span class="op">=</span> <span class="va">T10M</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_distiller</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, name <span class="op">=</span> <span class="st">"\u00B0C"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">month_name</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">kenya_sf</span>, fill <span class="op">=</span> <span class="cn">NA</span>, colour <span class="op">=</span> <span class="fu">alpha</span><span class="op">(</span><span class="st">"black"</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span>
<span class="fu">ggsave</span><span class="op">(</span><span class="st">"images/temperature_m_kenya.png"</span>, scale <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></code></pre></div>
</details><div class="figure" style="text-align: center">
<img src="../images/precipitation_m_kenya.png" alt="Precipitation by month in Kenya (2019), millimeters / hour (kg/m^2/hour)" width="1844"><p class="caption">
Precipitation by month in Kenya (2019), millimeters / hour (kg/m^2/hour)
</p>
</div>
</div>
<div id="air-temperature-by-months" class="section level2">
<h2 class="hasAnchor">
<a href="#air-temperature-by-months" class="anchor"></a>Air temperature by months</h2>
<div class="figure" style="text-align: center">
<img src="../images/temperature_m_kenya.png" alt="Average monthly temperature in Kenya (2019), °C)" width="1844"><p class="caption">
Average monthly temperature in Kenya (2019), °C)
</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Oleg Lugovoy, Shuo Gao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

---
title: "Solar Power"
output: rmarkdown::html_vignette
header-includes:
   - \usepackage{amsmath}
vignette: >
  %\VignetteIndexEntry{Solar Power}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(merra2ools)
library(tidyverse)
library("cowplot")

# Example dataset
merra <- merra2_sample(1, add.coord = T)
merra

```

# Plane of Array (POA) irradiance model
## All steps at once
```{r}
poa <- fPOA(merra)

```


## Step-by-step
### Solar postion
```{r}
x <- solar_position(merra, verbose = 0, keep.all = T)
x <- azimuth.convertion(x)
```

### Global Horizontal Irradiance decomposition
```{r}
x <- solar_irradiance(x, verbose=0, keep.all = T)

```

### PV-array position
```{r}
x <- pv_array_position(x, verbose = 0, array.type = "all")

```

### Angle of Incidence (AOI)
```{r}
x <- angle_of_incidence(x, verbose = 0, array.type = "all")
```

### Plane of Array (POA) irradiance 
```{r}
x <- poa_irradiance(x, verbose=0, array.type = "all", keep.all = F)

```



